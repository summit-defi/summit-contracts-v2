<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for contracts/Timelock.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">contracts/</a> Timelock.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">20.75% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>11/53</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">9.52% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>4/42</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">18.18% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>2/11</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">20.75% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>11/53</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">// SPDX-License-Identifier: MIT
&nbsp;
// COPIED FROM https://github.com/compound-finance/compound-protocol/blob/master/contracts/Governance/GovernorAlpha.sol
// Copyright 2020 Compound Labs, Inc.
// Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
// 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
// 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
// 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.
// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
&nbsp;
pragma solidity 0.8.0;
&nbsp;
contract Timelock {
    event NewAdmin(address indexed newAdmin);
    event NewPendingAdmin(address indexed newPendingAdmin);
    event NewDelay(uint indexed newDelay);
    event NewSpecificDelay(string signature, uint indexed newDelay);
    event CancelTransaction(bytes32 indexed txHash, address indexed target, uint value, string signature,  bytes data, uint eta);
    event ExecuteTransaction(bytes32 indexed txHash, address indexed target, uint value, string signature,  bytes data, uint eta);
    event QueueTransaction(bytes32 indexed txHash, address indexed target, uint value, string signature, bytes data, uint eta);
&nbsp;
    uint public constant GRACE_PERIOD = 14 days;
    uint public constant MINIMUM_DELAY = 6 hours;
    uint public constant MAXIMUM_DELAY = 30 days;
&nbsp;
    address public admin;
    address public pendingAdmin;
    uint public delay;
    bool public admin_initialized;
&nbsp;
    mapping (bytes4 =&gt; uint) public signatureSpecificDelay;
&nbsp;
    mapping (bytes32 =&gt; bool) public queuedTransactions;
&nbsp;
    constructor(address admin_, uint delay_) {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(delay_ &gt;= MINIMUM_DELAY, "Timelock::constructor: Delay must exceed minimum delay.");
        <span class="missing-if-branch" title="else path not taken" >E</span>require(delay_ &lt;= MAXIMUM_DELAY, "Timelock::constructor: Delay must not exceed maximum delay.");
&nbsp;
<span class="cstat-no" title="statement not covered" >        admin = admin_</span>;
<span class="cstat-no" title="statement not covered" >        delay = delay_</span>;
<span class="cstat-no" title="statement not covered" >        admin_initialized = false</span>;
    }
&nbsp;
    receive() external payable { }
&nbsp;
<span class="fstat-no" title="function not covered" >    function setDelay(uint delay_) public {</span>
<span class="cstat-no" title="statement not covered" >        require(msg.sender == address(this), "Timelock::setDelay: Call must come from Timelock.")</span>;
<span class="cstat-no" title="statement not covered" >        require(delay_ &gt;= MINIMUM_DELAY, "Timelock::setDelay: Delay must exceed minimum delay.")</span>;
        require(delay_ &lt;= MAXIMUM_DELAY, "Timelock::setDelay: Delay must not exceed maximum delay.");
<span class="cstat-no" title="statement not covered" >        delay = delay_</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        emit NewDelay(delay);</span>
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function sigToHash(string memory signature_) internal pure returns (bytes4) {</span>
<span class="cstat-no" title="statement not covered" >        return bytes4(keccak256(bytes(signature_)));</span>
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function setFunctionSpecificDelay(string memory signature_, uint specificDelay_) public {</span>
<span class="cstat-no" title="statement not covered" >        require(msg.sender == address(this), "Timelock::setDelay: Call must come from Timelock.")</span>;
<span class="cstat-no" title="statement not covered" >        require(specificDelay_ &gt;= delay, "Timelock::setDelay: Signature specific delay must exceed base delay.")</span>;
<span class="cstat-no" title="statement not covered" >        require(specificDelay_ &lt;= MAXIMUM_DELAY, "Timelock::setDelay: Signature specific delay must not exceed maximum delay.")</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        signatureSpecificDelay[sigToHash(signature_)] = specificDelay_</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        emit NewSpecificDelay(signature_, specificDelay_);</span>
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function getFunctionSpecificDelay(string memory signature_) public view returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return signatureSpecificDelay[sigToHash(signature_)];</span>
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function acceptAdmin() public {</span>
<span class="cstat-no" title="statement not covered" >        require(msg.sender == pendingAdmin, "Timelock::acceptAdmin: Call must come from pendingAdmin.")</span>;
<span class="cstat-no" title="statement not covered" >        admin = msg.sender</span>;
<span class="cstat-no" title="statement not covered" >        pendingAdmin = address(0)</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        emit NewAdmin(admin);</span>
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function setPendingAdmin(address pendingAdmin_) public {</span>
        // allows one time setting of admin for deployment purposes
<span class="cstat-no" title="statement not covered" >        if (admin_initialized) {</span>
<span class="cstat-no" title="statement not covered" >            require(msg.sender == address(this), "Timelock::setPendingAdmin: Call must come from Timelock.")</span>;
        } else {
<span class="cstat-no" title="statement not covered" >            require(msg.sender == admin, "Timelock::setPendingAdmin: First call must come from admin.")</span>;
            admin_initialized = true;
        }
        pendingAdmin = pendingAdmin_;
&nbsp;
        emit NewPendingAdmin(pendingAdmin);
    }
&nbsp;
    function queueTransaction(address target, uint value, string memory signature, bytes memory data, uint eta) public returns (bytes32) {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(msg.sender == admin, "Timelock::queueTransaction: Call must come from admin.");
        uint256 trueDelay = signatureSpecificDelay[sigToHash(signature)] &gt; delay ? signatureSpecificDelay[sigToHash(signature)] : delay;
&nbsp;
        <span class="missing-if-branch" title="else path not taken" >E</span>require(eta &gt;= getBlockTimestamp() + trueDelay, "Timelock::queueTransaction: Estimated execution block must satisfy delay.");
&nbsp;
        bytes32 txHash = keccak256(abi.encode(target, value, signature, data, eta));
<span class="cstat-no" title="statement not covered" >        queuedTransactions[txHash] = true</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        emit QueueTransaction(txHash, target, value, signature, data, eta);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        return txHash;</span>
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function cancelTransaction(address target, uint value, string memory signature, bytes memory data, uint eta) public {</span>
<span class="cstat-no" title="statement not covered" >        require(msg.sender == admin, "Timelock::cancelTransaction: Call must come from admin.")</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        bytes32 txHash = keccak256(abi.encode(target, value, signature, data, eta));</span>
<span class="cstat-no" title="statement not covered" >        queuedTransactions[txHash] = false</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        emit CancelTransaction(txHash, target, value, signature, data, eta);</span>
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function executeTransaction(address target, uint value, string memory signature, bytes memory data, uint eta) public payable returns (bytes memory) {</span>
<span class="cstat-no" title="statement not covered" >        require(msg.sender == admin, "Timelock::executeTransaction: Call must come from admin.")</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        bytes32 txHash = keccak256(abi.encode(target, value, signature, data, eta));</span>
<span class="cstat-no" title="statement not covered" >        require(queuedTransactions[txHash], "Timelock::executeTransaction: Transaction hasn't been queued.")</span>;
<span class="cstat-no" title="statement not covered" >        require(getBlockTimestamp() &gt;= eta, "Timelock::executeTransaction: Transaction hasn't surpassed time lock.")</span>;
<span class="cstat-no" title="statement not covered" >        require(getBlockTimestamp() &lt;= eta + GRACE_PERIOD, "Timelock::executeTransaction: Transaction is stale.")</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        queuedTransactions[txHash] = false</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        bytes memory callData;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (bytes(signature).length == 0) {</span>
<span class="cstat-no" title="statement not covered" >            callData = data</span>;
        } else {
<span class="cstat-no" title="statement not covered" >            callData = abi.encodePacked(bytes4(keccak256(bytes(signature))), data)</span>;
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        (bool success, bytes memory returnData) = target.call{value: value}(callData);</span>
        require(success, string(returnData));
&nbsp;
<span class="cstat-no" title="statement not covered" >        emit ExecuteTransaction(txHash, target, value, signature, data, eta);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        return returnData;</span>
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function getBlockTimestamp() internal view returns (uint) {</span>
        // solium-disable-next-line security/no-block-members
<span class="cstat-no" title="statement not covered" >        return block.timestamp;</span>
    }
}</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Tue Dec 14 2021 16:51:29 GMT+0100 (Central European Standard Time)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
